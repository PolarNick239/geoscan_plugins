# Экспортировать по фигурам

Плагин позволяет экспортировать ортофотопланы и цифровые модели местности по набору фигур.

## Содержание
- [Как это работает?](#как-это-работает)
- [Пример использования](#пример-использования)
- [Дополнительные опции экспорта](#дополнительные-опции-экспорта)
- [Примечание](#примечание)

### Как это работает?

Плагин получает на вход слой фигур (векторные полигоны с собственными названиями).
В процессе экспорта плагин по очереди берет каждую фигуру из слоя и использует ее как внешнюю границу в процессе экспорта. 
Результат - набор экспортированных растров в границах каждой из фигур. 
Название растра соответствует названию фигуры.

**Важно!** 
Следует учитывать, что перед началом обработки плагин собирает все активные фигуры в блоке и запоминает тип их границы. 
В процессе экспорта все внешние и внутренние границы будут учтены.

### Пример использования

Допустим, в нашем проекте есть слой с разграфкой с именем _Разграфка_ и построенные ортофотоплан и цифровая модель местности.
Задача - создать набор ортофотопланов и цифровых моделей в границах каждого квадрата разграфки.

Начнем с ортофотопланов. 
Для **Export source** зададим _Orthomosaic_ и определим несколько стандартных опций экспорта: 
система координат _WGS 84 UTM 36N_, формат _TIFF_, пространственное разрешение _5 см_ и др. 
Отдельно зададим путь к директории, в которую будет произведен экспорт (**Export path**).

![export_by_shapes1](https://user-images.githubusercontent.com/27758021/120050826-d765df00-c026-11eb-9bd5-ed40e0a97115.JPG)

Нажимаем **ОК** и получаем следующее окно.

![export_by_shapes2](https://user-images.githubusercontent.com/27758021/120051076-e731f300-c027-11eb-8b34-d484ac6be595.JPG)

Данное окно позволяет добавить еще одну задачу экспорта. 
Воспользуемся этой возможностью, чтобы сразу же экспортировать и цифровую модель местности.
Нажимаем **Add task**.

Теперь настроим экспорт цифровых моделей местности. 
Дополнительно зададим поправку по высоте _10 м_ и буфер _0.2 м_.
Это означает, что наши модели будут на 10 м выше, а границы квадрата разграфки расширятся на 0.2 м. 
Определив все необходимые опции, жмем **ОК**.

![export_by_shapes3](https://user-images.githubusercontent.com/27758021/120051495-860b1f00-c029-11eb-9cc9-0d93464ca3d5.JPG)

Теперь можно приступать к экспорту! Жмем **Export** и ожидаем результат.

![export_by_shapes4](https://user-images.githubusercontent.com/27758021/120051256-94a50680-c028-11eb-95fc-23a1dda70171.JPG)

Результатом являются два набора растров, имена которых соответствуют названиям фигур.

![export_by_shapes5](https://user-images.githubusercontent.com/27758021/120051354-f6fe0700-c028-11eb-8fdb-aeff030e11c0.JPG)

#### Экспорт с учетом существующих границ

Наличие внешних и внутренних границ для имеющейся разграфки - не проблема!
Они будут учтены в процессе экспорта.

![export_by_shapes6](https://user-images.githubusercontent.com/27758021/120051668-35e08c80-c02a-11eb-9970-f2dc00a01d55.JPG)

### Дополнительные опции экспорта

- **Height correction**. Используется только для цифровых моделей и позволяет задать поправку по высоте, 
  которая будет учтена в значениях пикселов экспортированного растра.
- **Buffer zone (m)**. Позволяет расширить или сузить границы каждой из используемых фигур 
  в процессе экспорта на заданное значение.
  
Отдельно следует упомянуть про формат **MTW**, который может быть использован при экспорте цифровых моделей местности.
При выборе этого формата возникает дополнительное окно интерфейса, в котором необходимо еще раз задать систему координат модели.
Эти параметры должны соответствовать основной системе координат экспорта. 
Такие сложности связаны с особенностями записи информации о системе координат в файл формата **MTW**.

### Примечание
- Не стоит использовать в процессе экспорта векторный слой, в котором большая часть фигур не пересекаются с растром. 
  Это замедлит работу программы.
